Imports System.Data.SqlClient

Public Class Form4


    Dim conexion As New SqlConnection("Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=Database1;Integrated Security=True;Encrypt=True")

    Private Sub Label1_Click(sender As Object, e As EventArgs) Handles Label1.Click
    End Sub

    Private Sub Label5_Click(sender As Object, e As EventArgs) Handles Label5.Click
    End Sub

    Private Sub Label7_Click(sender As Object, e As EventArgs) Handles Label7.Click
    End Sub

    Private Sub Password2_TextChanged(sender As Object, e As EventArgs) Handles Password2.TextChanged
    End Sub

    Private Sub password_TextChanged(sender As Object, e As EventArgs) Handles password.TextChanged
    End Sub

    Private Sub TextFechaDeNacimiento_TextChanged(sender As Object, e As EventArgs) Handles TextFechaDeNacimiento.TextChanged
    End Sub

    Private Sub TextCorreo_TextChanged(sender As Object, e As EventArgs) Handles TextCorreo.TextChanged
    End Sub

    Private Sub TextApellidoDeUsuario_TextChanged(sender As Object, e As EventArgs) Handles TextApellidoDeUsuario.TextChanged
    End Sub

    Private Sub TextNombreDeUsuario_TextChanged(sender As Object, e As EventArgs) Handles TextNombreDeUsuario.TextChanged
    End Sub

    Private Sub TextAutID_TextChanged(sender As Object, e As EventArgs) Handles TextAutID.TextChanged
    End Sub

    ' -------------------------------
    ' BOTÓN REGISTRAR → INSERTAR EN SQL
    ' -------------------------------
    Private Sub btnRegistrar_Click(sender As Object, e As EventArgs) Handles btnRegistrar.Click
        Try
            conexion.Open()
            Dim cmd As New SqlCommand("INSERT INTO Registro_de_usuario (Nombre_del_usuario, Apellido_del_usuario, Correo_electronico, Fecha_de_nacimiento, Password, AutID) 
                                       VALUES (@Nombre_del_usuario, @Apellido_del_usuario, @Correo_electronico, @Fecha_de_nacimiento, @Password, @AutID)", conexion)

            ' Parámetros con los valores de los TextBox
            cmd.Parameters.AddWithValue("@Nombre_del_usuario", TextNombreDeUsuario.Text)
            cmd.Parameters.AddWithValue("@Apellido_del_usuario", TextApellidoDeUsuario.Text)
            cmd.Parameters.AddWithValue("@Correo_electronico", TextCorreo.Text)
            cmd.Parameters.AddWithValue("@Fecha_de_nacimiento", TextFechaDeNacimiento.Text)
            cmd.Parameters.AddWithValue("@Password", password.Text)
            cmd.Parameters.AddWithValue("@AutID", TextAutID.Text)

            cmd.ExecuteNonQuery()
            MessageBox.Show("Usuario registrado correctamente ✅")

        Catch ex As Exception
            MessageBox.Show("Error al registrar: " & ex.Message)
        Finally
            conexion.Close()
        End Try
    End Sub


    Private Sub btnCancelar_Click(sender As Object, e As EventArgs) Handles btnCancelar.Click
        TextNombreDeUsuario.Clear()
        TextApellidoDeUsuario.Clear()
        TextCorreo.Clear()
        TextFechaDeNacimiento.Clear()
        password.Clear()
        Password2.Clear()
        TextAutID.Clear()
    End Sub

End Class